<form class="layui-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">标题</label>
            <div class="layui-input-inline">
                <input type="text" name="title" lay-verify="title" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-inline">
            <label style="margin-top: 28.5px" class="layui-form-label">封图</label>
            <div class="layui-input-inline zjoin-upload" >
                <img src="/layui/images/default-cover.png"  id="picture-image">
                <input type="hidden" name="picture" id="picture">
            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">内容</label>
        <div class="layui-input-block">
            <textarea class="layui-textarea layui-hide" name="content" lay-verify="content" id="content"></textarea>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit="" lay-filter="carousel-add">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>
</form>
<script src="/layui/js/modules/qiniu.js"></script>
<script>
    layui.use(['layedit','zjoin','jquery','form','layer','table'], function(){
        var layedit = layui.layedit,zjoin=layui.zjoin,$=layui.jquery,form=layui.form,layer=layui.layer,table=layui.table;
        var contentEdit = layedit.build('content'); //建立编辑器
        zjoin({image:$("#picture-image"),input:$("#picture")});
        form.verify({
            title: function(value){
                if(value.length < 5){
                    return '标题至少得5个字符啊';
                }
            }
            ,content: function(value){
                layedit.sync(contentEdit);
            }
        });

        form.on("submit(carousel-add)",function(data){
            $.ajax({
                url:'/admin/carousel/add',
                type:'post',
                data:data.field,
                success:function(){
                    layer.msg("发表成功！");
                    layer.closeAll();
                    table.reload('table_carousel_list', {
                        elem: '#table_carousel_list'
                        , id: 'table_carousel_list'
                        , url: '/admin/carousel/list'
                        , cols: [[
                            {checkbox: true, fixed: true}
                            , {field: 'title', title: '名称', width: 200}
                        ]]
                        , page: true
                        , height: 725
                    });
                }
            });
            return false;
        });
    });
</script>